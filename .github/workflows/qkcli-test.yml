name: qkcli-integration-test

on:
  push:
    branches:
      - master

jobs:
  mnt-test-using-qkcli:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          # In the future, add it as a submodule
          repository: QuarkChain/qkcli
          ref: master
          token: ${{ secrets.QKCLI_PAT }}
          path: qkcli
      - uses: actions/setup-go@v2
        with:
          go-version: "~1.14.4"
      - run: go version
      - run: |
          git clone https://github.com/516108736/goquarkchain
          echo "11"
          ls goquarkchain
          echo "222"
          cp goquarkchain/tests/ci-qkcli/runner.sh qkcli/tester/runner.sh
          cp goquarkchain/tests/ci-qkcli/testcases.txt  qkcli/tester/testcases.txt
          cd qkcli && go build  && go install &&cd tester   && ./runner.sh 0-auction-initialization-pause
